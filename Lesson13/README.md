# Практическая работа №13

**Тема:** Разработка мобильного приложения с использованием библиотек `Retrofit` и `Picasso` для работы с сетью.

## Цель работы

1. Освоить принципы выполнения сетевых запросов в Android-приложении с использованием библиотеки `Retrofit`.
2. Научиться обрабатывать данные, полученные от REST API в формате JSON.
3. Реализовать отображение списка данных с помощью `RecyclerView`.
4. Освоить асинхронную загрузку и отображение изображений из сети с помощью библиотеки `Picasso`.
  
---

## Реализация загрузки и отображения текстовых данных с помощью `Retrofit`.

1. Настройка проекта: Был создан новый модуль `retrofitapp.` В файл `build.gradle` были добавлены зависимости для библиотек `retrofit2` и `converter-gson`. В `AndroidManifest.xml` было добавлено разрешение на использование интернета (`<uses-permission android:name="android.permission.INTERNET" />`).
2. Создание модели данных: Был создан POJO-класс `Todo.java`, структура которого полностью соответствует полям JSON-объекта, получаемого от API `https://jsonplaceholder.typicode.com/todos`.
3. Создание API-интерфейса: Был создан интерфейс `ApiService.java`, в котором с помощью аннотаций `Retrofit (@GET("todos"))` был описан GET-запрос для получения списка задач.
4. Подготовка пользовательского интерфейса:
  - В `activity_main.xml` был добавлен компонент RecyclerView для отображения списка.
  - Был создан макет `item_todo.xml` для одного элемента списка, содержащий `TextView` для названия задачи и `CheckBox` для ее статуса.
5. Создание Адаптера: Был реализован `TodoAdapter.java` для `RecyclerView`, который принимает на вход список объектов Todo и связывает их с соответствующими элементами в макете `item_todo.xml`.
6. Выполнение сетевого запроса: В `MainActivity.java` был инициализирован `Retrofit`, создан экземпляр `ApiService`. Был выполнен асинхронный сетевой запрос с помощью метода c`all.enqueue()`. В колбэке onResponse() полученные данные были успешно переданы в `TodoAdapter`, после чего список дел отобразился на экране.

<img width="974" height="597" alt="image" src="https://github.com/user-attachments/assets/2b2352e2-c610-4a8f-9138-d923a7f2eef9" />

---

## Интеграция библиотеки `Picasso` для загрузки изображений.

1. Добавление зависимости: В `build.gradle` была добавлена зависимость для библиотеки `com.squareup.picasso:picasso`.
2. Модификация макета: В `item_todo.xml` был добавлен элемент `ImageView` для отображения изображения, соответствующего задаче.
3. Обновление Адаптера: Класс `TodoAdapter` был модифицирован:
  - В `TodoViewHolder` была добавлена ссылка на `ImageView`.
  - В методе `onBindViewHolder` был добавлен код для загрузки изображения с помощью Picasso. В качестве источника изображений был выбран сервис `https://loremflickr.com`, URL для которого формировался динамически с использованием ID задачи.

<img width="974" height="603" alt="image" src="https://github.com/user-attachments/assets/ff5b7d62-5a89-4504-aca1-e26f441de76f" />

---

## Контрольное задание

1. Настройка окружения: Добавление зависимостей `Retrofit`, `Gson` и `Glide` в `build.gradle.kts` и получение разрешения на доступ в интернет в `AndroidManifest.xml`.
2. Обновление моделей данных: Модификация моделей `Product` (domain-слой) и `ProductEntity` (data-слой) для работы с URL изображений (`imageUrl`) вместо локальных ресурсов (imageResName).
3. Создание сетевого слоя: Реализация Retrofit-клиента, интерфейса `ApiService` и класса `RetrofitNetworkApi`, который инкапсулирует логику выполнения сетевых запросов.
4. Интеграция с репозиторием: Модификация `ProductRepositoryImpl` для использования `RetrofitNetworkApi`. Реализована логика кэширования: при успешном сетевом запросе данные сохраняются в локальную базу данных `Room`, а при ошибке сети приложение использует ранее сохраненные данные.
5. Обновление UI-слоя: Адаптеры `ProductAdapter`, `FavoritesAdapter` и активити `ProductDetailsActivity` были обновлены для загрузки изображений по URL с помощью Glide.

<img width="974" height="566" alt="image" src="https://github.com/user-attachments/assets/b80a71fc-35c3-4834-9330-daac322f9385" />

<img width="974" height="579" alt="image" src="https://github.com/user-attachments/assets/d81310bb-834e-4733-a8fd-a6b688612fae" />

<img width="974" height="574" alt="image" src="https://github.com/user-attachments/assets/878b15b4-109a-471b-bb2b-74a356bd444f" />

---

## Итоги

В ходе выполнения практической работы были успешно освоены технологии для работы с сетью в Android:
- Библиотека `Retrofit` была успешно применена для выполнения GET-запросов к REST API, десериализации JSON-ответов в Java-объекты.
- Библиотека `Picasso` была интегрирована для асинхронной загрузки и кэширования изображений из сети.
- Успешно освоена библиотека `Glide`. 
- **SkinCare** успешно загружает данные о товарах с удаленного сервера.

---

**Выполнила**: Голышева Е.А.  
**Группа**: БСБО-09-22
