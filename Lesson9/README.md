# Практическая работа №9

**Тема:** Проектирование приложения в парадигме Clean Architecture. Use-case диаграмма, декомпозиция на слои (presentation/domain/data) и реализация каркаса приложения.

---

## Цель работы

Закрепить навыки:

- проектирования сценариев использования (Use Case) и акторов;

- декомпозиции мобильного приложения на слои presentation / domain / data;

- применения принципа Dependency Rule и инверсии зависимостей;

- реализации каркаса приложения с use-case классами и репозиторием;

- сохранения данных через SharedPreferences без «протечки» зависимостей в domain.
  
---

## Проектирование приложения

### USE-CASE диаграмма

В приложении **SkinCare** предусмотрены два актора: гость, который может просматривать каталог и карточки товаров, запрашивать UV/погоду и инициировать авторизацию, и авторизованный пользователь, дополнительно способный работать с избранным, оставлять отзывы, управлять «рутиной» ухода и выходить из аккаунта. Ключевые случаи использования включают просмотр каталога и карточки товара, где действия «Оставить отзыв» и «Добавить в избранное» выступают как extend к карточке; создание/редактирование рутины, распознавание типа кожи по фото (ML), получение UV и погоды из внешнего JSON-сервиса, а также авторизацию/регистрацию и выход. Операция «Сохранить данные в БД» оформлена как общий include для изменяющих состояние сценариев (избранное, отзывы, рутина).

<img width="974" height="564" alt="image" src="https://github.com/user-attachments/assets/128cef39-3260-42b4-a5ca-96740d4b8253" />

### Разделение на слои

Архитектурно приложение разделено на слои: Presentation (экраны Auth, Main, Details, SkinDetect с ViewModel), Domain (use-case’ы LoginUser, GetProductList, GetProductById, DetectSkinType и контракты AuthRepository, ProductRepository, MIRepository) и Data (реализации AuthRepositoryImpl, ProductRepositoryImpl, MIRepositoryTFLite, источники Retrofit, Room и TFLite-модель).

<img width="974" height="1046" alt="image" src="https://github.com/user-attachments/assets/7300f669-9d05-4d69-ad96-f862d593c576" />

---

## Реализация каркаса приложения

Был создан новый проект `ru.mirea.golysheva.Lesson9`. Каркас построен по принципам **Clean Architecture** с разделением на presentation / domain / data и направлением зависимостей внутрь. Взаимодействие с данными идёт через абстракцию `MovieRepository`, определённую в domain и предоставляющую две операции — сохранить и получить «любимый» фильм; бизнес-логика оформлена двумя use case — `SaveMovieToFavoriteUseCase` и `GetFavoriteFilmUseCase`, которые получают репозиторий через конструктор (инверсия зависимостей). Конкретная реализация репозитория находится в data и хранит значение в `SharedPreferences` с простой валидацией и дефолтом («Бегущий в лабиринте»), тем самым изолируя Android-детали. В UI (`MainActivity`) репозиторий передаётся в use case: кнопка сохранения берёт текст из поля и запускает `Save…`, а кнопка отображения читает его через `Get…`; интерфейс опирается только на use case и не знает о механизме хранения.

<img width="974" height="1242" alt="image" src="https://github.com/user-attachments/assets/ee22a8b6-b93c-485c-8171-7dabf564b0df" />

<img width="974" height="1121" alt="image" src="https://github.com/user-attachments/assets/4f03f9e9-0815-4915-908f-e6081da62922" />

<img width="974" height="1251" alt="image" src="https://github.com/user-attachments/assets/57d5dde2-0f13-4642-893a-8fae452480e7" />

<img width="974" height="1237" alt="image" src="https://github.com/user-attachments/assets/b53d2003-eb5d-4909-98b5-8638ba5687f9" />

---

## Проектирование и реализация приложения SkinCare

Был создан новый проект `ru.mirea.golysheva.SkinCare` с базовой активностью и минимальной разметкой, служащий «болванкой» для дальнейшего наращивания. Сразу разнесена структура по слоям: в **domain** добавлены классы use-case согласно проектированию (получение списка/деталей, авторизация/иное по ТЗ) и объявлены интерфейсы репозиториев; в **data** подготовлены заглушки реализаций этих репозиториев, которые возвращают тестовые данные (фиктивные сущности/списки без реальной сети и БД), а также простые мапперы при необходимости. В презентационном слое подключены use-case к стартовой активности/VM, чтобы подтвердить поток UI → use-case → repository → test data и убедиться, что домен остаётся без Android-зависимостей. В итоге получен рабочий каркас: проект собирается, use-case вызываются, тестовые данные отображаются, архитектурные границы соблюдены и готовы к замене заглушек на реальные источники (Room/Retrofit/TFLite) без изменений в domain и UI.

<img width="974" height="835" alt="image" src="https://github.com/user-attachments/assets/6110e0cf-d39b-43bd-9ada-c8892d47c617" />

<img width="860" height="1518" alt="image" src="https://github.com/user-attachments/assets/2dcb3c60-c408-4a3e-9e3e-c302541d8c1f" />

<img width="968" height="1518" alt="image" src="https://github.com/user-attachments/assets/c98f5fae-4ba5-4644-aa86-75df19a1c20a" />

<img width="955" height="1518" alt="image" src="https://github.com/user-attachments/assets/60bdeb0f-77c2-4ca4-ac71-bafc93b54e6e" />

<img width="974" height="1290" alt="image" src="https://github.com/user-attachments/assets/9c4d31eb-1c75-46ea-ab5d-c93de298f70a" />

---

## Итоги

В ходе практики спроектирован и развернут каркас приложений в парадигме Clean Architecture: определены акторы и Use Case для SkinCare, подготовлены диаграммы и разбиение на слои (presentation/domain/data), созданы доменные сущности и use-case’ы, объявлены контракты репозиториев и реализованы их заглушки c тестовыми данными. На примере MovieProject реализован механизм сохранения/чтения «любимого фильма» через SharedPreferences при строгой изоляции Android-зависимостей в слое data; проверены пользовательские потоки и отображение результатов на экране (по скринам). Проекты собираются, use-case’ы вызываются через UI, данные корректно возвращаются, что подтверждает работоспособность архитектурного каркаса и готовность к дальнейшему наращиванию функционала (Room/Retrofit/TFLite) без изменений в domain и UI.

---

**Выполнила**: Голышева Е.А.  
**Группа**: БСБО-09-22
